<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.8.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"21guns.top","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="[toc] TP-Link wr886nv6固件分析00-准备 binwalk固件  123456789101112# 除了前3外，其余都是lzma压缩过的数据# 偏移0xa200处uncompressed size: 2365008 bytes,最大，猜测其可能包含一些有用的数据lxl@ubuntu:~/Desktop/tmp$ binwalk wr886nv6.bin DECIMAL">
<meta name="keywords" content="路由器,固件分析">
<meta property="og:type" content="article">
<meta property="og:title" content="TP-Link wr886nv6固件分析">
<meta property="og:url" content="http://21guns.top/2021/05/09/iot/TP-Link wr886nv6固件分析/index.html">
<meta property="og:site_name" content="have a nice day">
<meta property="og:description" content="[toc] TP-Link wr886nv6固件分析00-准备 binwalk固件  123456789101112# 除了前3外，其余都是lzma压缩过的数据# 偏移0xa200处uncompressed size: 2365008 bytes,最大，猜测其可能包含一些有用的数据lxl@ubuntu:~/Desktop/tmp$ binwalk wr886nv6.bin DECIMAL">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2021-01-15-050134.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2021-01-15-050140.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2021-01-15-50139.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2021-01-15-050135.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2021-01-15-050138.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2021-01-15-050137.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2021-01-15-050139.jpg">
<meta property="og:updated_time" content="2022-02-22T01:44:49.694Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="TP-Link wr886nv6固件分析">
<meta name="twitter:description" content="[toc] TP-Link wr886nv6固件分析00-准备 binwalk固件  123456789101112# 除了前3外，其余都是lzma压缩过的数据# 偏移0xa200处uncompressed size: 2365008 bytes,最大，猜测其可能包含一些有用的数据lxl@ubuntu:~/Desktop/tmp$ binwalk wr886nv6.bin DECIMAL">
<meta name="twitter:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2021-01-15-050134.jpg">

<link rel="canonical" href="http://21guns.top/2021/05/09/iot/TP-Link wr886nv6固件分析/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>TP-Link wr886nv6固件分析 | have a nice day</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">have a nice day</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://21guns.top/2021/05/09/iot/TP-Link wr886nv6固件分析/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="21Guns">
      <meta itemprop="description" content>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="have a nice day">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          TP-Link wr886nv6固件分析
        </h1>

        <div class="post-meta">

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-05-09 14:41:33" itemprop="dateCreated datePublished" datetime="2021-05-09T14:41:33+08:00">2021-05-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-02-22 09:44:49" itemprop="dateModified" datetime="2022-02-22T09:44:49+08:00">2022-02-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/IOT安全/" itemprop="url" rel="index"><span itemprop="name">IOT安全</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>[toc]</p>
<h1 id="TP-Link-wr886nv6固件分析"><a href="#TP-Link-wr886nv6固件分析" class="headerlink" title="TP-Link wr886nv6固件分析"></a>TP-Link wr886nv6固件分析</h1><h2 id="00-准备"><a href="#00-准备" class="headerlink" title="00-准备"></a>00-准备</h2><ul>
<li>binwalk固件</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 除了前3外，其余都是lzma压缩过的数据</span></span><br><span class="line"><span class="comment"># 偏移0xa200处uncompressed size: 2365008 bytes,最大，猜测其可能包含一些有用的数据</span></span><br><span class="line">lxl@ubuntu:~/Desktop/tmp$ binwalk wr886nv6.bin </span><br><span class="line"></span><br><span class="line">DECIMAL       HEXADECIMAL     DESCRIPTION</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">12656         0x3170          U-Boot version string, <span class="string">"U-Boot 1.1.4 (May  8 2016 - 07:42:47)"</span></span><br><span class="line">12704         0x31A0          CRC32 polynomial table, big endian</span><br><span class="line">13932         0x366C          uImage header, header size: 64 bytes, header CRC: 0x773178DD, created: 2016-05-08 14:42:48, image size: 20788 bytes, Data Address: 0x80010000, Entry Point: 0x80010000, data CRC: 0x983BDABA, OS: Linux, CPU: MIPS, image <span class="built_in">type</span>: Firmware Image, compression <span class="built_in">type</span>: lzma, image name: <span class="string">"u-boot image"</span></span><br><span class="line">13996         0x36AC          LZMA compressed data, properties: 0x5D, dictionary size: 8388608 bytes, uncompressed size: 52148 bytes</span><br><span class="line">41472         0xA200          LZMA compressed data, properties: 0x6E, dictionary size: 8388608 bytes, uncompressed size: 2365008 bytes</span><br><span class="line">791104        0xC1240         LZMA compressed data, properties: 0x5A, dictionary size: 8388608 bytes, uncompressed size: 1731 bytes</span><br></pre></td></tr></table></figure>
<ul>
<li>binwalk 进一步 a200//here</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 猜测是路由器主程序（怎么判定的？</span></span><br><span class="line"><span class="comment"># vxwork主程序：集成了httpd等多种二进制的程序，vxworks = 主程序 + web文件 + kernel + uboot</span></span><br><span class="line">lxl@ubuntu:~/Desktop/tmp$ binwalk a200-3</span><br><span class="line"></span><br><span class="line">DECIMAL       HEXADECIMAL     DESCRIPTION</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">1846404       0x1C2C84        Certificate <span class="keyword">in</span> DER format (x509 v3), header length: 4, sequence length: 4</span><br><span class="line">1853692       0x1C48FC        Certificate <span class="keyword">in</span> DER format (x509 v3), header length: 4, sequence length: 4</span><br><span class="line">1898688       0x1CF8C0        VxWorks operating system version <span class="string">"5.5.1"</span> , compiled: <span class="string">"Sep 20 2017, 09:16:35"</span></span><br><span class="line">1955289       0x1DD5D9        Unix path: /basicRouter/wireless/qca956x/os/vxWorks/wbuf_private.h, line 279</span><br><span class="line">1955524       0x1DD6C4        Unix path: /basicRouter/wireless/qca956x/os/vxWorks/wbuf_private.h, line 365</span><br><span class="line">1964105       0x1DF849        Unix path: /basicRouter/wireless/qca956x/os/vxWorks/osdep.h, line 1525</span><br><span class="line">1967556       0x1E05C4        Copyright string: <span class="string">"Copyright(C) 2001-2011 by TP-LINK TECHNOLOGIES CO., LTD."</span></span><br><span class="line">1997244       0x1E79BC        VxWorks WIND kernel version <span class="string">"2.6"</span></span><br><span class="line">2042360       0x1F29F8        HTML document header</span><br><span class="line">2042425       0x1F2A39        HTML document footer</span><br><span class="line">2062192       0x1F7770        PEM certificate</span><br><span class="line">2062248       0x1F77A8        PEM RSA private key</span><br><span class="line">2071532       0x1F9BEC        Base64 standard index table</span><br><span class="line">2106544       0x2024B0        CRC32 polynomial table, big endian</span><br><span class="line">2107568       0x2028B0        CRC32 polynomial table, big endian</span><br><span class="line">2108592       0x202CB0        CRC32 polynomial table, big endian</span><br><span class="line">2109616       0x2030B0        CRC32 polynomial table, big endian</span><br><span class="line">2130316       0x20818C        XML document, version: <span class="string">"1.0"</span></span><br><span class="line">2149736       0x20CD68        SHA256 <span class="built_in">hash</span> constants, big endian</span><br><span class="line">2247821       0x224C8D        StuffIt Deluxe Segment (data): f</span><br><span class="line">2247852       0x224CAC        StuffIt Deluxe Segment (data): fError</span><br><span class="line">2247933       0x224CFD        StuffIt Deluxe Segment (data): f</span><br><span class="line">2364653       0x2414ED        Unix path: /2/3/4/5/6</span><br></pre></td></tr></table></figure>
<h2 id="01-vxworks主程序"><a href="#01-vxworks主程序" class="headerlink" title="01-vxworks主程序"></a>01-vxworks主程序</h2><h3 id="1-1-定位"><a href="#1-1-定位" class="headerlink" title="1-1-定位"></a>1-1-定位</h3><ul>
<li>firmware中那么多section，哪个是？</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1 binwalk -Me，信息最多</span></span><br><span class="line">Scan Time:     2021-01-11 17:31:44</span><br><span class="line">Target File:   /home/lxl/Desktop/tmp/_wr886nv6.bin.extracted/A200</span><br><span class="line">MD5 Checksum:  3b45621ea1615616a548c79e971f3ad7</span><br><span class="line">Signatures:    344</span><br><span class="line"></span><br><span class="line">DECIMAL       HEXADECIMAL     DESCRIPTION</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">1846404       0x1C2C84        Certificate <span class="keyword">in</span> DER format (x509 v3), header length: 4, sequence length: 4</span><br><span class="line">1853692       0x1C48FC        Certificate <span class="keyword">in</span> DER format (x509 v3), header length: 4, sequence length: 4</span><br><span class="line">1898688       0x1CF8C0        VxWorks operating system version <span class="string">"5.5.1"</span> , compiled: <span class="string">"Sep 20 2017, 09:16:35"</span></span><br><span class="line">1955289       0x1DD5D9        Unix path: /basicRouter/wireless/qca956x/os/vxWorks/wbuf_private.h, line 279</span><br><span class="line">1955524       0x1DD6C4        Unix path: /basicRouter/wireless/qca956x/os/vxWorks/wbuf_private.h, line 365</span><br><span class="line">1964105       0x1DF849        Unix path: /basicRouter/wireless/qca956x/os/vxWorks/osdep.h, line 1525</span><br><span class="line">1967556       0x1E05C4        Copyright string: <span class="string">"Copyright(C) 2001-2011 by TP-LINK TECHNOLOGIES CO., LTD."</span></span><br><span class="line">1997244       0x1E79BC        VxWorks WIND kernel version <span class="string">"2.6"</span></span><br><span class="line">2042360       0x1F29F8        HTML document header</span><br><span class="line">2042425       0x1F2A39        HTML document footer</span><br><span class="line">2062192       0x1F7770        PEM certificate</span><br><span class="line">2062248       0x1F77A8        PEM RSA private key</span><br><span class="line">2071532       0x1F9BEC        Base64 standard index table</span><br><span class="line">2106544       0x2024B0        CRC32 polynomial table, big endian</span><br><span class="line">2107568       0x2028B0        CRC32 polynomial table, big endian</span><br><span class="line">2108592       0x202CB0        CRC32 polynomial table, big endian</span><br><span class="line">2109616       0x2030B0        CRC32 polynomial table, big endian</span><br><span class="line">2130316       0x20818C        XML document, version: <span class="string">"1.0"</span></span><br><span class="line">2149736       0x20CD68        SHA256 <span class="built_in">hash</span> constants, big endian</span><br><span class="line">2247821       0x224C8D        StuffIt Deluxe Segment (data): f</span><br><span class="line">2247852       0x224CAC        StuffIt Deluxe Segment (data): fError</span><br><span class="line">2247933       0x224CFD        StuffIt Deluxe Segment (data): f</span><br><span class="line">2364653       0x2414ED        Unix path: /2/3/4/5/6</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2 tree，提取后东西也最多</span></span><br><span class="line">├── _A200.extracted</span><br><span class="line">│   ├── 1C2C84.crt</span><br><span class="line">│   ├── 1C48FC.crt</span><br><span class="line">│   ├── 1F29F8</span><br><span class="line">│   ├── 1F7770.crt</span><br><span class="line">│   ├── 1F77A8.key</span><br><span class="line">│   ├── 20818C.xml</span><br><span class="line">│   ├── 224C8D.sit</span><br><span class="line">│   ├── 224CAC.sit</span><br><span class="line">│   └── 224CFD.sit</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3 binwalk + firmware时，所有lzma压缩过的数据中，size最大</span></span><br><span class="line">lxl@ubuntu:~/Desktop/tmp$ binwalk wr886nv6.bin </span><br><span class="line">41472         0xA200          LZMA compressed data, properties: 0x6E, dictionary size: 8388608 bytes, uncompressed size: 2365008 bytes</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4 综上，firmware中A200为主程序</span></span><br></pre></td></tr></table></figure>
<h3 id="1-2-提取"><a href="#1-2-提取" class="headerlink" title="1-2-提取"></a>1-2-提取</h3><ul>
<li>dd提取并解压a200</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1 binwalk确定偏移、大小</span></span><br><span class="line">lxl@ubuntu:~/Desktop/tmp$ binwalk wr886nv6.bin </span><br><span class="line">13996         0x36AC          LZMA compressed data, properties: 0x5D, dictionary size: 8388608 bytes, uncompressed size: 52148 bytes</span><br><span class="line">41472         0xA200          LZMA compressed data, properties: 0x6E, dictionary size: 8388608 bytes, uncompressed size: 2365008 bytes</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2 skip=在firmware中的偏移=41472=0xA200，count=749643=791104-41472</span></span><br><span class="line">lxl@ubuntu:~/Desktop/tmp$ dd <span class="keyword">if</span>=wr886nv6.bin of=a200.lzma bs=1 skip=41472 count=749632  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 3 解压失败</span></span><br><span class="line"><span class="comment"># unlzma等同于lzma -d</span></span><br><span class="line"><span class="comment"># 其实win下的7zip是可以的，可忽略尾部的垃圾数据（尽管提示“有效数据外包含额外数据”）</span></span><br><span class="line">lxl@ubuntu:~/Desktop/tmp$ unlzma -d a200.lzma </span><br><span class="line">unlzma: a200.lzma: Compressed data is corrupt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4 hexdump看a200，注意到：MINIFS字符串，并且前面全是ff</span></span><br><span class="line">lxl@ubuntu:~/Desktop/tmp$ hexdump a200.lzma -C |tail</span><br><span class="line">000b6290  39 30 5a fb 6f 5c 65 63  97 42 d1 69 e3 13 e5 ba  |90Z.o\ec.B.i....|</span><br><span class="line">000b62a0  03 0b ba 40 fb 20 27 05  c2 c4 64 d9 fe 98 78 de  |...@. <span class="string">'...d...x.|</span></span><br><span class="line"><span class="string">000b62b0  be 68 ff ff ff ff ff ff  ff ff ff ff ff ff ff ff  |.h..............|</span></span><br><span class="line"><span class="string">000b62c0  ff ff ff ff ff ff ff ff  ff ff ff ff ff ff ff ff  |................|</span></span><br><span class="line"><span class="string">*</span></span><br><span class="line"><span class="string">000b7000  4d 49 4e 49 46 53 00 00  00 00 00 00 00 00 00 00  |MINIFS..........|</span></span><br><span class="line"><span class="string">000b7010  00 00 00 02 00 00 00 86  00 01 f4 00 00 07 55 7c  |..............U||</span></span><br><span class="line"><span class="string">000b7020  92 1c 64 4e ae 88 d9 d2  2d b4 48 ce 5c eb 69 51  |..dN....-.H.\.iQ|</span></span><br><span class="line"><span class="string">000b7030  00 00 04 8d 00 00 00 20  00 00 06 c3 00 00 00 00  |....... ........|</span></span><br><span class="line"><span class="string">000b7040</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 5 去掉minifs部分，仍失败（749568 = 0x000b7000）</span></span><br><span class="line"><span class="string">lxl@ubuntu:~/Desktop/tmp$ dd if=a200.lzma of=a200-2.lzma bs=1 skip=0 count=749568</span></span><br><span class="line"><span class="string">lxl@ubuntu:~/Desktop/tmp$ hexdump a200-2.lzma -C |tail</span></span><br><span class="line"><span class="string">000b6250  59 eb fd 7d 1b ba e1 f7  8e 80 97 5a 47 ac 2d 76  |Y..&#125;.......ZG.-v|</span></span><br><span class="line"><span class="string">000b6260  7a 5a 92 5a 70 b8 44 e1  fb 68 0c ea 65 44 66 39  |zZ.Zp.D..h..eDf9|</span></span><br><span class="line"><span class="string">000b6270  40 b2 28 ee 1c 99 d2 42  15 34 2a cb 1d 47 1a b5  |@.(....B.4*..G..|</span></span><br><span class="line"><span class="string">000b6280  50 0f 17 65 1f ee 46 eb  f9 ca c2 13 29 11 9a fe  |P..e..F.....)...|</span></span><br><span class="line"><span class="string">000b6290  39 30 5a fb 6f 5c 65 63  97 42 d1 69 e3 13 e5 ba  |90Z.o\ec.B.i....|</span></span><br><span class="line"><span class="string">000b62a0  03 0b ba 40 fb 20 27 05  c2 c4 64 d9 fe 98 78 de  |...@. '</span>...d...x.|</span><br><span class="line">000b62b0  be 68 ff ff ff ff ff ff  ff ff ff ff ff ff ff ff  |.h..............|</span><br><span class="line">000b62c0  ff ff ff ff ff ff ff ff  ff ff ff ff ff ff ff ff  |................|</span><br><span class="line">*</span><br><span class="line">000b7000</span><br><span class="line">lxl@ubuntu:~/Desktop/tmp$ unlzma a200-2.lzma </span><br><span class="line">unlzma: a200-2.lzma: Compressed data is corrupt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 6 再去掉ff部分，成功</span></span><br><span class="line"><span class="comment"># （746162 = 0x000b62b0 + 2），要+2，因为count从1，而hexdump从0开始</span></span><br><span class="line">lxl@ubuntu:~/Desktop/tmp$ dd <span class="keyword">if</span>=a200.lzma of=a200-3.lzma bs=1 skip=0 count=746162</span><br><span class="line">lxl@ubuntu:~/Desktop/tmp$ hexdump a200-3.lzma -C |tail</span><br><span class="line">000b6230  f4 15 97 db 1c 72 79 dc  b0 91 d9 ac 36 85 2f 41  |.....ry.....6./A|</span><br><span class="line">000b6240  50 <span class="built_in">fc</span> 24 f5 c5 d0 b5 63  32 0c 00 d2 f5 97 d7 33  |P.$....c2......3|</span><br><span class="line">000b6250  59 eb fd 7d 1b ba e1 f7  8e 80 97 5a 47 ac 2d 76  |Y..&#125;.......ZG.-v|</span><br><span class="line">000b6260  7a 5a 92 5a 70 b8 44 e1  fb 68 0c ea 65 44 66 39  |zZ.Zp.D..h..eDf9|</span><br><span class="line">000b6270  40 b2 28 ee 1c 99 d2 42  15 34 2a cb 1d 47 1a b5  |@.(....B.4*..G..|</span><br><span class="line">000b6280  50 0f 17 65 1f ee 46 eb  f9 ca c2 13 29 11 9a fe  |P..e..F.....)...|</span><br><span class="line">000b6290  39 30 5a fb 6f 5c 65 63  97 42 d1 69 e3 13 e5 ba  |90Z.o\ec.B.i....|</span><br><span class="line">000b62a0  03 0b ba 40 fb 20 27 05  c2 c4 64 d9 fe 98 78 de  |...@. <span class="string">'...d...x.|</span></span><br><span class="line"><span class="string">000b62b0  be 68                                             |.h|</span></span><br><span class="line"><span class="string">000b62b2</span></span><br><span class="line"><span class="string">lxl@ubuntu:~/Desktop/tmp$ unlzma a200-3.lzma </span></span><br><span class="line"><span class="string">lxl@ubuntu:~/Desktop/tmp$ ls</span></span><br><span class="line"><span class="string">a200-2.lzma  a200-3  a200.lzma  wr886nv6.bin</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 7 其实，直接用win下的7zip就可，会自动忽略尾部的垃圾数据（尽管提示“有效数据外包含额外数据”）</span></span><br><span class="line"><span class="string"># 当然，binwalk -e也可</span></span><br></pre></td></tr></table></figure>
<h3 id="1-3-判定架构"><a href="#1-3-判定架构" class="headerlink" title="1-3-判定架构"></a>1-3-判定架构</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1 -Y参数看架构，mips，大端</span></span><br><span class="line">lxl@ubuntu:~/Desktop/tmp$ binwalk -Y a200-3 </span><br><span class="line">DECIMAL       HEXADECIMAL     DESCRIPTION</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">672           0x2A0           MIPS executable code, 32/64-bit, big endian, at least 845 valid instructions</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2 uImage header中为mips、CRC32中为big endian（同一个固件中，主程序与这两者的架构信息应该可对应）</span></span><br><span class="line">lxl@ubuntu:~/Desktop/tmp$ binwalk wr886nv6.bin </span><br><span class="line">DECIMAL       HEXADECIMAL     DESCRIPTION</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">12656         0x3170          U-Boot version string, <span class="string">"U-Boot 1.1.4 (May  8 2016 - 07:42:47)"</span></span><br><span class="line">12704         0x31A0          CRC32 polynomial table, big endian<span class="comment"># big endian</span></span><br><span class="line">13932         0x366C          uImage header, header size: 64 bytes, header CRC: 0x773178DD, created: 2016-05-08 14:42:48, image size: 20788 bytes, Data Address: 0x80010000, Entry Point: 0x80010000, data CRC: 0x983BDABA, OS: Linux, CPU: MIPS, image <span class="built_in">type</span>: Firmware Image, compression <span class="built_in">type</span>: lzma, image name: <span class="string">"u-boot image"</span><span class="comment"># CPU: MIPS</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3 综上，mips，大端</span></span><br></pre></td></tr></table></figure>
<h3 id="1-4-确定基址（未找到"><a href="#1-4-确定基址（未找到" class="headerlink" title="1-4-确定基址（未找到"></a>1-4-确定基址（未找到</h3><h4 id="解压主程序的程序"><a href="#解压主程序的程序" class="headerlink" title="解压主程序的程序"></a>解压主程序的程序</h4><ul>
<li>找到解压主程序的boot程序-36ac</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 主程序a200是lzma压缩的，运行时肯定会有另一个程序来解压它</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># binwalk看firmware，有一个uImage header，其image name: "u-boot image"，这只是一个header文件，其主体文件肯定在后面那一堆lzma数据中</span></span><br><span class="line">lxl@ubuntu:~/Desktop/tmp$ binwalk wr886nv6.bin </span><br><span class="line">DECIMAL       HEXADECIMAL     DESCRIPTION</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">13932         0x366C          uImage header, header size: 64 bytes, header CRC: 0x773178DD, created: 2016-05-08 14:42:48, image size: 20788 bytes, Data Address: 0x80010000, Entry Point: 0x80010000, data CRC: 0x983BDABA, OS: Linux, CPU: MIPS, image <span class="built_in">type</span>: Firmware Image, compression <span class="built_in">type</span>: lzma, image name: <span class="string">"u-boot image"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># binwalk -Me，36AC的描述，可断定其为u-boot程序（对应前面的header），其来解压主程序a200</span></span><br><span class="line">Scan Time:     2021-01-11 17:31:44</span><br><span class="line">Target File:   /home/lxl/Desktop/tmp/_wr886nv6.bin.extracted/36AC</span><br><span class="line">MD5 Checksum:  a26046acdb2729cde979b969d2f33a56</span><br><span class="line">Signatures:    344</span><br><span class="line"></span><br><span class="line">DECIMAL       HEXADECIMAL     DESCRIPTION</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">44976         0xAFB0          U-Boot version string, <span class="string">"U-Boot 1.1.4 (May  8 2016 - 07:42:44)"</span></span><br><span class="line">45248         0xB0C0          CRC32 polynomial table, big endian</span><br></pre></td></tr></table></figure>
<ul>
<li>dd提取并解压出boot程序</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 同上a200的解压：直接7zip或去除尾部垃圾后unlzma</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># binwalk找偏移</span></span><br><span class="line">13996         0x36AC          LZMA compressed data, properties: 0x5D, dictionary size: 8388608 bytes, uncompressed size: 52148 bytes</span><br><span class="line">41472         0xA200          LZMA compressed data, properties: 0x6E, dictionary size: 8388608 bytes, uncompressed size: 2365008 bytes</span><br><span class="line"></span><br><span class="line"><span class="comment"># 尾部有垃圾数据，解压失败（skip=36ac的偏移，count=41472-13996</span></span><br><span class="line">lxl@ubuntu:~/Desktop/tmp$ dd <span class="keyword">if</span>=wr886nv6.bin of=36ac.lzma bs=1 skip=13996 count=27476</span><br><span class="line">lxl@ubuntu:~/Desktop/tmp$ unlzma 36ac.lzma </span><br><span class="line">unlzma: 36ac.lzma: Compressed data is corrupt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看尾部垃圾（可看出，同样有ff，但不同于a200，没有minifs字符串</span></span><br><span class="line">lxl@ubuntu:~/Desktop/tmp$ hexdump 36ac.lzma -C | tail -n 30</span><br><span class="line">000050a0  f1 2a 48 66 e5 dd 1d 11  06 2a 34 6c c8 a1 3a 7e  |.*Hf.....*4l..:~|</span><br><span class="line">000050b0  62 f7 9e ba 50 ef d1 fb  48 1f 19 c9 df 48 de bb  |b...P...H....H..|</span><br><span class="line">000050c0  07 8a 2c 82 b6 8d 4f 1f  90 94 f1 5b 29 d3 bf aa  |..,...O....[)...|</span><br><span class="line">000050d0  6e dc 84 93 5d d7 45 b2  a6 ae b0 da 5a 09 43 00  |n...].E.....Z.C.|</span><br><span class="line">000050e0  cf 45 f4 72 95 0e 4b b8  e1 <span class="built_in">cd</span> 1b 18 f6 2d 05 f6  |.E.r..K......-..|</span><br><span class="line">000050f0  29 8d 5d 0c fe 44 14 15  87 15 35 4c dc f3 86 0e  |).]..D....5L....|</span><br><span class="line">00005100  82 20 23 60 a4 66 0d 3c  ed 29 88 d6 ce d6 df 05  |. <span class="comment">#`.f.&lt;.)......|</span></span><br><span class="line">00005110  c7 94 31 a2 5e f3 52 35  0f 87 f8 88 08 1b 3f f8  |..1.^.R5......?.|</span><br><span class="line">00005120  05 30 7c 4a f3 7f be a3  ec 8e b1 55 f2 3f 65 76  |.0|J.......U.?ev|</span><br><span class="line">00005130  db 8c 59 4b ff ff ff ff  ff ff ff ff ff ff ff ff  |..YK............|</span><br><span class="line">00005140  ff ff ff ff ff ff ff ff  ff ff ff ff ff ff ff ff  |................|</span><br><span class="line">*</span><br><span class="line">00006950  ff ff ff ff 00 00 01 00  55 aa 9d d1 a8 c8 83 31  |........U......1|</span><br><span class="line">00006960  c9 69 fb bf bc f0 d4 32  70 c7 aa 55 80 00 10 00  |.i.....2p..U....|</span><br><span class="line">00006970  80 00 10 00 00 00 00 00  00 00 00 09 00 00 00 00  |................|</span><br><span class="line">00006980  00 02 00 00 00 02 00 00  00 00 08 00 00 02 08 00  |................|</span><br><span class="line">00006990  00 00 08 00 00 02 10 00  00 00 70 00 00 02 80 00  |..........p.....|</span><br><span class="line">000069a0  00 00 9e 00 00 03 1e 00  00 00 02 00 00 03 20 00  |.............. .|</span><br><span class="line">000069b0  00 0b 62 b2 00 0e 90 00  00 07 55 9c 00 00 00 00  |..b.......U.....|</span><br><span class="line">000069c0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|</span><br><span class="line">*</span><br><span class="line">000069e0  00 00 00 00 bf cc fd 9a  46 ff f6 15 <span class="built_in">cd</span> 6c 25 07  |........F....l%.|</span><br><span class="line">000069f0  51 e0 e9 b9 85 d8 28 30  f3 f8 36 b3 c5 90 11 d9  |Q.....(0..6.....|</span><br><span class="line">00006a00  58 25 c2 05 8d f8 94 d0  64 75 c4 9d 68 a4 ab 91  |X%......du..h...|</span><br><span class="line">00006a10  ee 3a 3d 72 4d 79 46 69  72 6d 77 61 72 65 00 00  |.:=rMyFirmware..|</span><br><span class="line">00006a20  00 00 00 01 5f 21 b3 de  0a 18 0d ac 96 78 6f 23  |...._!.......xo<span class="comment">#|</span></span><br><span class="line">00006a30  57 b5 ae 3f 00 00 00 00  00 00 00 00 00 00 00 00  |W..?............|</span><br><span class="line">00006a40  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|</span><br><span class="line">*</span><br><span class="line">00006b54</span><br><span class="line"></span><br><span class="line"><span class="comment"># 去除尾部垃圾后，成功（20778=0x5130+4，并非+3，因为hexdump中从0开始）</span></span><br><span class="line">lxl@ubuntu:~/Desktop/tmp$ dd <span class="keyword">if</span>=36ac.lzma of=36ac-2.lzma bs=1 skip=0 count=20788</span><br><span class="line">lxl@ubuntu:~/Desktop/tmp$ unlzma 36ac-2.lzma </span><br><span class="line">lxl@ubuntu:~/Desktop/tmp$ ls</span><br><span class="line">36ac-2  36ac.lzma  a200-3  a200.lzma  binwalk-Me.txt  wr886nv6.bin  _wr886nv6.bin.extracted</span><br></pre></td></tr></table></figure>
<ul>
<li>ida加载uboot程序-36ac</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># uImage header中：mips架构、Entry Point=0x80010000即加载基址</span></span><br><span class="line">13932         0x366C          uImage header, header size: 64 bytes, header CRC: 0x773178DD, created: 2016-05-08 14:42:48, image size: 20788 bytes, Data Address: 0x80010000, Entry Point: 0x80010000, data CRC: 0x983BDABA, OS: Linux, CPU: MIPS, image <span class="built_in">type</span>: Firmware Image, compression <span class="built_in">type</span>: lzma, image name: <span class="string">"u-boot image"</span></span><br><span class="line"><span class="comment"># -Y中：big endian</span></span><br><span class="line">lxl@ubuntu:~/Desktop/tmp$ binwalk -Y 36ac-2 </span><br><span class="line">DECIMAL       HEXADECIMAL     DESCRIPTION</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">148           0x94            MIPS executable code, 32/64-bit, big endian, at least 1250 valid instructions</span><br><span class="line"><span class="comment"># 综上：mips、大端、加载基址0x80010000</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 加载器只有最原始的：binary file</span></span><br><span class="line"><span class="comment"># processor选择mipsb</span></span><br><span class="line"><span class="comment"># 选中manual load，出现disassembly memory organization（或者不选，加载后就会默认打开</span></span><br><span class="line"><span class="comment"># 内存布局中：input file的loading address指定0x80010000、loading size默认就是文件大小、file offset默认0即可</span></span><br><span class="line"><span class="comment"># 选择创建rom section，address和size同input file（作用未知，但ram和rom必须选一个</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 第一个字节处，快捷键c将byte转化为code，随后ida会自动分析//并没有自动分析，是不是因为没有头的原因？</span></span><br></pre></td></tr></table></figure>
<ul>
<li>刚打开，啥也没有：函数为0、开头只是bytes没有具体指令、导航带全是unexpolred（（是不是需要加上之前那个header，怎么加？</li>
</ul>
<p><img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2021-01-15-050134.jpg" alt="image-20210112100328569"></p>
<ul>
<li>通过此法未找到</li>
</ul>
<h4 id="其他文章涉及"><a href="#其他文章涉及" class="headerlink" title="其他文章涉及"></a>其他文章涉及</h4><ul>
<li><p><a href="https://www.secpulse.com/archives/75635.html：在对0xA200地址之前的一些数据进行分析后可以看到一个疑似uimage" target="_blank" rel="noopener">https://www.secpulse.com/archives/75635.html：在对0xA200地址之前的一些数据进行分析后可以看到一个疑似uimage</a> header的数据段，其中有两处地址指向了0x80001000，这个地址也和很多同类路由器设备的固件加载地址相同，因此我们可以尝试使用该地址作为固件加载地址进行分析。</p>
</li>
<li><p><a href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/”，主程序的加载基址也为“80001000”" target="_blank" rel="noopener">http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/”，主程序的加载基址也为“80001000”</a></p>
</li>
</ul>
<h4 id="可疑点"><a href="#可疑点" class="headerlink" title="可疑点"></a>可疑点</h4><p>36ac解压前的36ac.lzma的尾部数据有“80001000”，这些结构是什么？</p>
<h4 id="vxhunter插件"><a href="#vxhunter插件" class="headerlink" title="vxhunter插件"></a>vxhunter插件</h4><p><a href="https://github.com/PAGalaxyLab/vxhunter/blob/master/README.zh-cn.md" target="_blank" rel="noopener">https://github.com/PAGalaxyLab/vxhunter/blob/master/README.zh-cn.md</a></p>
<ul>
<li>ghidra：帮助文档中，目标是vxworks的固件，实测：固件、a200均失败（Windows、script manager、manager script directory、添加vxhunter的python脚本所在目录</li>
<li>ida：文档中deme也不知道是咋用的</li>
</ul>
<h3 id="1-5-ida加载"><a href="#1-5-ida加载" class="headerlink" title="1-5-ida加载"></a>1-5-ida加载</h3><ul>
<li>加载基址0x80001000，架构mips大端<ul>
<li>并没有在boot程序36ac中找到80001000</li>
<li>36ac解压前的36ac.lzma尾部数据中有“80001000”，据文章“<a href="https://www.secpulse.com/archives/75635.html”，说是加载基址和入口点，但具体未知" target="_blank" rel="noopener">https://www.secpulse.com/archives/75635.html”，说是加载基址和入口点，但具体未知</a></li>
<li>之前也有文章“<a href="http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/”，主程序的加载基址也为“80001000”" target="_blank" rel="noopener">http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/”，主程序的加载基址也为“80001000”</a></li>
<li>36ac解压前的36ac.lzma的尾部数据有“80001000”，这些结构是什么？</li>
<li>故暂且这样吧，到底怎么确定的未知</li>
</ul>
</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 加载器只有最原始的：binary file</span></span><br><span class="line"><span class="comment"># processor选择mipsb</span></span><br><span class="line"><span class="comment"># 选中manual load，出现disassembly memory organization（或者不选，加载后就会默认打开</span></span><br><span class="line"><span class="comment"># 内存布局中：input file的loading address指定0x80010000、loading size默认就是文件大小、file offset默认0即可</span></span><br><span class="line"><span class="comment"># 选择创建rom section，address和size同input file（作用未知，但ram和rom必须选一个</span></span><br></pre></td></tr></table></figure>
<ul>
<li>68识别出6149，而75识别出2210（75中需要手动p成函数，而68中自动识别了），why？68版np就行了</li>
<li>Imports和Exports都是空的，因为没有导入符号表</li>
</ul>
<h2 id="02-符号表文件"><a href="#02-符号表文件" class="headerlink" title="02-符号表文件"></a>02-符号表文件</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># binwalk -Me提取固件，目录中搜索vxworkx中函数，如bzero</span></span><br><span class="line">lxl@ubuntu:~/Desktop/tmp$ <span class="built_in">cd</span> _wr886nv6.bin.extracted/</span><br><span class="line">lxl@ubuntu:~/Desktop/tmp/_wr886nv6.bin.extracted$ grep -r bzero .</span><br><span class="line">Binary file ./C2E3A matches</span><br></pre></td></tr></table></figure>
<ul>
<li>winhex中，大量的VxWorks的函数名（00分割），推测是符号表</li>
</ul>
<p><img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2021-01-15-050140.jpg" alt="image-20210112152211065"></p>
<ul>
<li>找到函数名的起始地址头，找各个函数名的偏移（相对于大量函数名开头的偏移，而非文件开始）</li>
</ul>
<p><img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2021-01-15-50139.jpg" alt="image-20210112152819753"></p>
<ul>
<li>文件最开始处，是有规律的，前8个字节后，是某结构体数组，结构体三个成员：1字节 + 3字节 + 4字节</li>
</ul>
<p><img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2021-01-15-050135.jpg" alt="image-20210112154024425"></p>
<ul>
<li>IDA中g到4字节的地址处，恰好是函数的开头</li>
</ul>
<p><img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2021-01-15-050138.jpg" alt="image-20210112154323935"></p>
<ul>
<li>综上，结构体三个成员：1字节-类型、3字节-文件偏移、4字节-内存偏移</li>
</ul>
<h2 id="03-IDA脚本修复"><a href="#03-IDA脚本修复" class="headerlink" title="03-IDA脚本修复"></a>03-IDA脚本修复</h2><ul>
<li>根据符号表文件，获取函数名</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 有需求时再细看</span></span><br><span class="line"><span class="keyword">import</span> idautils</span><br><span class="line"><span class="keyword">import</span> idc</span><br><span class="line"><span class="keyword">import</span> idaapi</span><br><span class="line"></span><br><span class="line">symfile_path = <span class="string">'./C2E3A'</span>    </span><br><span class="line">symbols_table_start = <span class="number">8</span></span><br><span class="line">strings_table_start = <span class="number">0x9d00</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(symfile_path, <span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    symfile_contents = f.read()</span><br><span class="line"></span><br><span class="line">symbols_table = symfile_contents[symbols_table_start:strings_table_start]</span><br><span class="line">strings_table = symfile_contents[strings_table_start:]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_string_by_offset</span><span class="params">(offset)</span>:</span></span><br><span class="line">    index = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">        <span class="keyword">if</span> strings_table[offset+index] != <span class="string">'\x00'</span>:</span><br><span class="line">            index += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> strings_table[offset:offset+index]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_symbols_metadata</span><span class="params">()</span>:</span></span><br><span class="line">    symbols = []</span><br><span class="line">    <span class="keyword">for</span> offset <span class="keyword">in</span> xrange(<span class="number">0</span>, len(symbols_table),<span class="number">8</span>):</span><br><span class="line">        symbol_item = symbols_table[offset:offset+<span class="number">8</span>]</span><br><span class="line">        flag = symbol_item[<span class="number">0</span>]</span><br><span class="line">        string_offset = int(symbol_item[<span class="number">1</span>:<span class="number">4</span>].encode(<span class="string">'hex'</span>), <span class="number">16</span>)</span><br><span class="line">        string_name = get_string_by_offset(string_offset)</span><br><span class="line">        target_address = int(symbol_item[<span class="number">-4</span>:].encode(<span class="string">'hex'</span>), <span class="number">16</span>)</span><br><span class="line">        symbols.append((flag, string_name, target_address))</span><br><span class="line">    <span class="keyword">return</span> symbols</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add_symbols</span><span class="params">(symbols_meta_data)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> flag, string_name, target_address <span class="keyword">in</span> symbols_meta_data:</span><br><span class="line">        idc.MakeName(target_address, string_name)</span><br><span class="line">        <span class="keyword">if</span> flag == <span class="string">'\x54'</span>:</span><br><span class="line">            idc.MakeCode(target_address)</span><br><span class="line">            idc.MakeFunction(target_address)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    symbols_metadata = get_symbols_metadata()</span><br><span class="line">    add_symbols(symbols_metadata)</span><br></pre></td></tr></table></figure>
<ul>
<li>运行前，都是未识别的函数名</li>
</ul>
<p><img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2021-01-15-050137.jpg" alt="image-20210112154939203"></p>
<ul>
<li>运行后，解析符号表文件C2E3A，获取了函数名</li>
</ul>
<p><img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2021-01-15-050139.jpg" alt="image-20210112155059641"></p>
<h2 id="04-其他"><a href="#04-其他" class="headerlink" title="04-其他"></a>04-其他</h2><ul>
<li>uncompressed size是解压后文件的大小</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># lzma压缩的数据，uncompressed size是解压后文件的大小</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 0x36AC为52148，0xA200为2365008</span></span><br><span class="line">lxl@ubuntu:~/Desktop/tmp$ binwalk wr886nv6.bin </span><br><span class="line">13996         0x36AC          LZMA compressed data, properties: 0x5D, dictionary size: 8388608 bytes, uncompressed size: 52148 bytes</span><br><span class="line">41472         0xA200          LZMA compressed data, properties: 0x6E, dictionary size: 8388608 bytes, uncompressed size: 2365008 bytes</span><br><span class="line"></span><br><span class="line"><span class="comment"># ll验证</span></span><br><span class="line"><span class="comment"># dd从firmware中提取、dd去掉尾部ff等垃圾数据、unlzma解压</span></span><br><span class="line">lxl@ubuntu:~/Desktop/tmp$ ll</span><br><span class="line">-rw-r--r--  1 lxl lxl   52148 Jan 12 09:40 36ac-2</span><br><span class="line">-rw-r--r--  1 lxl lxl 2365008 Jan 11 17:01 a200-3</span><br></pre></td></tr></table></figure>
<ul>
<li>dd提取出待lzma解压的文件，尾部有垃圾数据（从ffff开始），这些数据是什么？</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 36ac，怀疑是解压主程序a200的boot程序</span></span><br><span class="line"><span class="comment"># 注意到有两个80 00 10 00，MyFirmware字符串</span></span><br><span class="line"><span class="comment"># 其他文章中说是：load address 和 entry point，也确实是主程序的加载基址</span></span><br><span class="line">lxl@ubuntu:~/Desktop/tmp$ hexdump 36ac.lzma -C | tail -n 30</span><br><span class="line">000050a0  f1 2a 48 66 e5 dd 1d 11  06 2a 34 6c c8 a1 3a 7e  |.*Hf.....*4l..:~|</span><br><span class="line">000050b0  62 f7 9e ba 50 ef d1 fb  48 1f 19 c9 df 48 de bb  |b...P...H....H..|</span><br><span class="line">000050c0  07 8a 2c 82 b6 8d 4f 1f  90 94 f1 5b 29 d3 bf aa  |..,...O....[)...|</span><br><span class="line">000050d0  6e dc 84 93 5d d7 45 b2  a6 ae b0 da 5a 09 43 00  |n...].E.....Z.C.|</span><br><span class="line">000050e0  cf 45 f4 72 95 0e 4b b8  e1 <span class="built_in">cd</span> 1b 18 f6 2d 05 f6  |.E.r..K......-..|</span><br><span class="line">000050f0  29 8d 5d 0c fe 44 14 15  87 15 35 4c dc f3 86 0e  |).]..D....5L....|</span><br><span class="line">00005100  82 20 23 60 a4 66 0d 3c  ed 29 88 d6 ce d6 df 05  |. <span class="comment">#`.f.&lt;.)......|</span></span><br><span class="line">00005110  c7 94 31 a2 5e f3 52 35  0f 87 f8 88 08 1b 3f f8  |..1.^.R5......?.|</span><br><span class="line">00005120  05 30 7c 4a f3 7f be a3  ec 8e b1 55 f2 3f 65 76  |.0|J.......U.?ev|</span><br><span class="line">00005130  db 8c 59 4b ff ff ff ff  ff ff ff ff ff ff ff ff  |..YK............|</span><br><span class="line">00005140  ff ff ff ff ff ff ff ff  ff ff ff ff ff ff ff ff  |................|</span><br><span class="line">*</span><br><span class="line">00006950  ff ff ff ff 00 00 01 00  55 aa 9d d1 a8 c8 83 31  |........U......1|</span><br><span class="line">00006960  c9 69 fb bf bc f0 d4 32  70 c7 aa 55 80 00 10 00  |.i.....2p..U....|<span class="comment"># 加载基址</span></span><br><span class="line">00006970  80 00 10 00 00 00 00 00  00 00 00 09 00 00 00 00  |................|</span><br><span class="line">00006980  00 02 00 00 00 02 00 00  00 00 08 00 00 02 08 00  |................|</span><br><span class="line">00006990  00 00 08 00 00 02 10 00  00 00 70 00 00 02 80 00  |..........p.....|</span><br><span class="line">000069a0  00 00 9e 00 00 03 1e 00  00 00 02 00 00 03 20 00  |.............. .|</span><br><span class="line">000069b0  00 0b 62 b2 00 0e 90 00  00 07 55 9c 00 00 00 00  |..b.......U.....|</span><br><span class="line">000069c0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|</span><br><span class="line">*</span><br><span class="line">000069e0  00 00 00 00 bf cc fd 9a  46 ff f6 15 <span class="built_in">cd</span> 6c 25 07  |........F....l%.|</span><br><span class="line">000069f0  51 e0 e9 b9 85 d8 28 30  f3 f8 36 b3 c5 90 11 d9  |Q.....(0..6.....|</span><br><span class="line">00006a00  58 25 c2 05 8d f8 94 d0  64 75 c4 9d 68 a4 ab 91  |X%......du..h...|</span><br><span class="line">00006a10  ee 3a 3d 72 4d 79 46 69  72 6d 77 61 72 65 00 00  |.:=rMyFirmware..|</span><br><span class="line">00006a20  00 00 00 01 5f 21 b3 de  0a 18 0d ac 96 78 6f 23  |...._!.......xo<span class="comment">#|</span></span><br><span class="line">00006a30  57 b5 ae 3f 00 00 00 00  00 00 00 00 00 00 00 00  |W..?............|</span><br><span class="line">00006a40  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|</span><br><span class="line">*</span><br><span class="line">00006b54</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># a200，这是主程序</span></span><br><span class="line"><span class="comment"># 注意到：MINIFS字符串</span></span><br><span class="line">lxl@ubuntu:~/Desktop/tmp$ hexdump a200.lzma -C |tail</span><br><span class="line">000b6290  39 30 5a fb 6f 5c 65 63  97 42 d1 69 e3 13 e5 ba  |90Z.o\ec.B.i....|</span><br><span class="line">000b62a0  03 0b ba 40 fb 20 27 05  c2 c4 64 d9 fe 98 78 de  |...@. <span class="string">'...d...x.|</span></span><br><span class="line"><span class="string">000b62b0  be 68 ff ff ff ff ff ff  ff ff ff ff ff ff ff ff  |.h..............|</span></span><br><span class="line"><span class="string">000b62c0  ff ff ff ff ff ff ff ff  ff ff ff ff ff ff ff ff  |................|</span></span><br><span class="line"><span class="string">*</span></span><br><span class="line"><span class="string">000b7000  4d 49 4e 49 46 53 00 00  00 00 00 00 00 00 00 00  |MINIFS..........|</span></span><br><span class="line"><span class="string">000b7010  00 00 00 02 00 00 00 86  00 01 f4 00 00 07 55 7c  |..............U||</span></span><br><span class="line"><span class="string">000b7020  92 1c 64 4e ae 88 d9 d2  2d b4 48 ce 5c eb 69 51  |..dN....-.H.\.iQ|</span></span><br><span class="line"><span class="string">000b7030  00 00 04 8d 00 00 00 20  00 00 06 c3 00 00 00 00  |....... ........|</span></span><br><span class="line"><span class="string">000b7040</span></span><br></pre></td></tr></table></figure>
<ul>
<li>问题<ul>
<li>68与75识别函数数量不同，why？</li>
<li>80001000加载基址怎么出来的？（见01-5-ida加载</li>
</ul>
</li>
</ul>
<blockquote>
<p>参考</p>
<ul>
<li><a href="https://cq674350529.github.io/2018/09/19/TP-Link-wr886v6-固件解析/" target="_blank" rel="noopener">https://cq674350529.github.io/2018/09/19/TP-Link-wr886v6-固件解析/</a></li>
<li><a href="https://www.secpulse.com/archives/75635.html" target="_blank" rel="noopener">https://www.secpulse.com/archives/75635.html</a></li>
</ul>
</blockquote>
<p># </p>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>21Guns
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://21guns.top/2021/05/09/iot/TP-Link wr886nv6固件分析/" title="TP-Link wr886nv6固件分析">http://21guns.top/2021/05/09/iot/TP-Link wr886nv6固件分析/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/路由器/" rel="tag"># 路由器</a>
              <a href="/tags/固件分析/" rel="tag"># 固件分析</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/04/20/iot/BLE设备的安全分析/" rel="prev" title="BLE设备的安全分析">
      <i class="fa fa-chevron-left"></i> BLE设备的安全分析
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/05/10/iot/Cisco RV34X中的提权漏洞/" rel="next" title="Cisco RV34X中的提权漏洞">
      Cisco RV34X中的提权漏洞 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#TP-Link-wr886nv6固件分析"><span class="nav-number">1.</span> <span class="nav-text">TP-Link wr886nv6固件分析</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#00-准备"><span class="nav-number">1.1.</span> <span class="nav-text">00-准备</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#01-vxworks主程序"><span class="nav-number">1.2.</span> <span class="nav-text">01-vxworks主程序</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-定位"><span class="nav-number">1.2.1.</span> <span class="nav-text">1-1-定位</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-提取"><span class="nav-number">1.2.2.</span> <span class="nav-text">1-2-提取</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-判定架构"><span class="nav-number">1.2.3.</span> <span class="nav-text">1-3-判定架构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-确定基址（未找到"><span class="nav-number">1.2.4.</span> <span class="nav-text">1-4-确定基址（未找到</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#解压主程序的程序"><span class="nav-number">1.2.4.1.</span> <span class="nav-text">解压主程序的程序</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#其他文章涉及"><span class="nav-number">1.2.4.2.</span> <span class="nav-text">其他文章涉及</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#可疑点"><span class="nav-number">1.2.4.3.</span> <span class="nav-text">可疑点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#vxhunter插件"><span class="nav-number">1.2.4.4.</span> <span class="nav-text">vxhunter插件</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-5-ida加载"><span class="nav-number">1.2.5.</span> <span class="nav-text">1-5-ida加载</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#02-符号表文件"><span class="nav-number">1.3.</span> <span class="nav-text">02-符号表文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#03-IDA脚本修复"><span class="nav-number">1.4.</span> <span class="nav-text">03-IDA脚本修复</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#04-其他"><span class="nav-number">1.5.</span> <span class="nav-text">04-其他</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="21Guns" src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">21Guns</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">164</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">71</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="vx:lxllxllx1" title="Wechat → vx:lxllxllx1" rel="noopener" target="_blank"><i class="fab fa-weixin fa-fw"></i>Wechat</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://github.com/21Gun5" title="GitHub → https://github.com/21Gun5" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2016 – 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">21Guns</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script size="300" alpha="0.5" zindex="0" src="/lib/canvas-ribbon/canvas-ribbon.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/pisces.js"></script>
<script src="/js/next-boot.js"></script>



  




  <script src="/js/local-search.js"></script>












  

  

</body>
</html>
